

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fragment libraries evaluation with fragPELE &mdash; pele platform 1.6.4 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="GPCR orthosteric site simulation" href="../gpcr/index.html" />
    <link rel="prev" title="fragPELE simulation" href="../frag/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> pele platform
          

          
          </a>

          
            
            
              <div class="version">
                1.6.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Release history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs/index.html">Frequently asked questions (FAQs)</a></li>
</ul>
<p class="caption"><span class="caption-text">Using the Platform</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../pele/index.html">PELE basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">Input files preparation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Simulation packages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../induced_fit/index.html">Induced fit docking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rescoring/index.html">Rank multiple putative poses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../site_finder/index.html">Site finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ppi/index.html">Protein-protein interface simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frag/index.html">fragPELE simulation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Fragment libraries evaluation with fragPELE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inputs">Inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-parameters">Default parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recommendations">Recommendations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complex-preparation">1. Complex Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#protein-scaffold-pdb-file">Protein-scaffold PDB file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#directory-with-fragments">Directory with fragments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#input-preparation">2. Input Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optional-parameters">Optional Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-frag-core-atom">Defining frag_core_atom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-simulation">3. Run simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">4. Output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scored-fragments">Scored fragments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#top-poses">Top poses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#analysis">5. Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpcr/index.html">GPCR orthosteric site simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interaction_restrictions/index.html">Interaction-restricted induced fit docking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../migration/binding.html">Out –&gt; in simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../migration/unbinding.html">In –&gt; out simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bias/index.html">Biased simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pca/index.html">Large protein conformational moves with PCA-PELE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../minimization/index.html">Protein minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sidechain_perturbation/index.html">Sidechain perturbation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis/index.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">Advanced tips and tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment/index.html">Environment variables</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pele platform</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Simulation packages</a> &raquo;</li>
        
      <li>Fragment libraries evaluation with fragPELE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/packages/libraries/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fragment-libraries-evaluation-with-fragpele">
<h1>Fragment libraries evaluation with fragPELE<a class="headerlink" href="#fragment-libraries-evaluation-with-fragpele" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>FragPELE is able to grow fragments from custom-made libraries. All you have to do is provide it with a directory
containing your fragments (in PDB or SDF format) and a docked core to let the software rank your fragments and return the
best binding modes for each.</p>
<div class="section" id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>protein-scaffold PDB file</p></li>
<li><p>directory with fragment files (SDF or PDB)</p></li>
<li><p>input.yaml configuration file</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="default-parameters">
<h3>Default parameters<a class="headerlink" href="#default-parameters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>frag_eq_steps: 20</p></li>
<li><p>gr_steps: 6</p></li>
<li><p>frag_steps: 3</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="recommendations">
<h3>Recommendations<a class="headerlink" href="#recommendations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>Computational time is estimated between 30min and 3h per fragment (depending on the number of rotatable bonds).</p></li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="complex-preparation">
<h2>1. Complex Preparation<a class="headerlink" href="#complex-preparation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="protein-scaffold-pdb-file">
<h3>Protein-scaffold PDB file<a class="headerlink" href="#protein-scaffold-pdb-file" title="Permalink to this headline">¶</a></h3>
<p>The PDB file should be preprocessed with Maestro Protein Preparation Wizard. We usually recommend protonating the
protein (obligatory), deleting water molecules more than 5Å away from ligands and ions as well as filling in missing
loops and side chains.</p>
<p>The file must contain protein in complex with a fragment (scaffold), e.g. an X-ray structure or a docked pose.
Additionally, ensure the ligand has:</p>
<blockquote>
<div><ul class="simple">
<li><p>unique chain ID</p></li>
<li><p>no atom names with spaces or single letters (occasionally Maestro adds hydrogens named <code class="docutils literal notranslate"><span class="pre">H1</span> <span class="pre">2</span></code>, these need to be corrected)</p></li>
<li><p>any unique residue name, except for <code class="docutils literal notranslate"><span class="pre">UNK</span></code></p></li>
<li><p>well-defined aromatic bonds.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="directory-with-fragments">
<h3>Directory with fragments<a class="headerlink" href="#directory-with-fragments" title="Permalink to this headline">¶</a></h3>
<p>The fragment library should be preprocessed using Schrodinger LigPrep (default settings should be sufficient) and
have unique molecule names.</p>
</div>
</div>
<div class="section" id="input-preparation">
<h2>2. Input Preparation<a class="headerlink" href="#input-preparation" title="Permalink to this headline">¶</a></h2>
<p>Prepare input.yaml file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">frag_core</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;complex.pdb&quot;</span><span class="w">  </span><span class="c1"># Protein-scaffold complex</span><span class="w"></span>
<span class="nt">frag_library</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/home/username/aromatic_library&quot;</span><span class="w">  </span><span class="c1"># Folder containing fragment files</span><span class="w"></span>
<span class="nt">resname</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LIG&quot;</span><span class="w">  </span><span class="c1"># Ligand scaffold residue name</span><span class="w"></span>
<span class="nt">chain_core</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;L&quot;</span><span class="w">  </span><span class="c1"># Ligand scaffold chain ID</span><span class="w"></span>
<span class="nt">frag_core_atom</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;C6-H6&quot;</span><span class="w">  </span><span class="c1"># Connection point from which you want to grow the fragments</span><span class="w"></span>
<span class="nt">cpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">48</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="optional-parameters">
<h3>Optional Parameters<a class="headerlink" href="#optional-parameters" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>frag_restart_libraries</strong>: To resume a fragment libraries simulation.</p></li>
<li><p><strong>fragment_atom</strong>: Select a hydrogen of the fragment that we want to attach to the <strong>frag_core_atom</strong>, instead of performing a simulation from every hydrogen of the fragment.</p></li>
</ul>
</div>
<div class="section" id="defining-frag-core-atom">
<h3>Defining frag_core_atom<a class="headerlink" href="#defining-frag-core-atom" title="Permalink to this headline">¶</a></h3>
<p>Not sure how to define <code class="docutils literal notranslate"><span class="pre">frag_core_atom</span></code>?
Open your PDB file in Schrodinger Maestro and hover over the atoms to see their PDB names on the panel below.
The starting point for fragment growing should consist of a heavy atom and a hydrogen, e.g. “C6-H6” on the picture below.</p>
<a class="reference internal image-reference" href="../../_images/libraries_2.png"><img alt="../../_images/libraries_2.png" class="align-center" src="../../_images/libraries_2.png" style="width: 400px;" /></a>
</div>
</div>
<div class="section" id="run-simulation">
<h2>3. Run simulation<a class="headerlink" href="#run-simulation" title="Permalink to this headline">¶</a></h2>
<p>To run the system launch the simulation with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pele_platform.main</span> <span class="pre">input.yml</span></code></p>
</div>
<div class="section" id="output">
<h2>4. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The simulation will create a TSV file with scored fragments as well as a number of fragment folders, the names of which will consist of the scaffold and molecule names.</p>
<div class="section" id="scored-fragments">
<h3>Scored fragments<a class="headerlink" href="#scored-fragments" title="Permalink to this headline">¶</a></h3>
<p>The list of all grown fragments together with their associated scores (average binding energy of the top 25% of all poses)
can be found in:</p>
<p><code class="docutils literal notranslate"><span class="pre">simulation_score.tsv</span></code></p>
</div>
<div class="section" id="top-poses">
<h3>Top poses<a class="headerlink" href="#top-poses" title="Permalink to this headline">¶</a></h3>
<p>Each fragment folder contains a top_results folder with PDB files corresponding to the best poses for that fragment:</p>
<p><code class="docutils literal notranslate"><span class="pre">fragment_folder/top_results/</span></code></p>
</div>
</div>
<div class="section" id="analysis">
<h2>5. Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>Once your simulation is finished, you can run an automated analysis to retrieve most promising fragments based on their
proximity to a certain point, for example a side chain atom you would like your fragment to interact with.</p>
<p>All you have to do is adjust your input.yaml and launch it as before. Ensure you:</p>
<blockquote>
<div><ul class="simple">
<li><p>provide PELE with the path to your working folder, i.e. where you launched your simulation in the first place</p></li>
<li><p>set <code class="docutils literal notranslate"><span class="pre">only_analysis:</span> <span class="pre">true</span></code></p></li>
<li><p>set your desired coordinates in <code class="docutils literal notranslate"><span class="pre">analysis_to_point</span></code>.</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">frag_core</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;complex.pdb&quot;</span><span class="w">  </span><span class="c1"># Protein-scaffold complex</span><span class="w"></span>
<span class="nt">frag_library</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/home/username/aromatic_library&quot;</span><span class="w">  </span><span class="c1"># Folder containing fragment files</span><span class="w"></span>
<span class="nt">resname</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LIG&quot;</span><span class="w">  </span><span class="c1"># Ligand scaffold residue name</span><span class="w"></span>
<span class="nt">chain_core</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;L&quot;</span><span class="w">  </span><span class="c1"># Ligand scaffold chain ID</span><span class="w"></span>
<span class="nt">frag_core_atom</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;C6-H6&quot;</span><span class="w">  </span><span class="c1"># Connection point from which you want to grow the fragments</span><span class="w"></span>
<span class="nt">only_analysis</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">analysis_to_point</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">24.835</span><span class="p p-Indicator">,</span><span class="w">  </span><span class="nv">73.161</span><span class="p p-Indicator">,</span><span class="w">  </span><span class="nv">17.026</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="nt">working_folder</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/home/username/LIG_Pele&quot;</span><span class="w"></span>
<span class="nt">cpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">48</span><span class="w"></span>
</pre></div>
</div>
<p>The script will produce a <code class="docutils literal notranslate"><span class="pre">point_analysis.csv</span></code> file containing a number of columns:</p>
<blockquote>
<div><ul>
<li><p><strong>File</strong>: Working folder</p></li>
<li><p><strong>BestFileDistance</strong>: File with the best distance</p>
<blockquote>
<div><ul class="simple">
<li><p>Distance: Best distance to the point</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>BestFileBE</strong>: File with the best energy of the simulation</p>
<blockquote>
<div><ul class="simple">
<li><p>BE: Best energy</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>BestFileNormalization</strong>: File with the best distance and energy of the simulation <strong>(recommended)</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>BestNormalization: Best sqrt(distance^2 + energy^2)</p></li>
<li><p>DistanceBestNormalization: Best distance of the file above</p></li>
<li><p>BEBestNormalization: Best energy of the file above</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gpcr/index.html" class="btn btn-neutral float-right" title="GPCR orthosteric site simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../frag/index.html" class="btn btn-neutral float-left" title="fragPELE simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        
        &copy; <a href="../../copyright.html">Copyright</a> 2021, NBD | Nostrum Biodiscovery

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>